---
sidebar_position: 99
title: "ERC1155Mod"
description: "ERC-1155 Token Receiver Interface - Handles the receipt of a single ERC-1155 token type."
---

import DocHero from '@site/src/components/docs/DocHero';
import Callout from '@site/src/components/ui/Callout';


## Overview

ERC1155Mod is a module that facilitates the management of ERC-1155 token types in a diamond storage pattern. It provides functions for minting, burning, transferring, and managing token metadata with compliance to the EIP-1155 standard. It ensures safe interactions with contracts and is designed for seamless integration in diamond proxy architectures.


[View Source](https://github.com/maxnorm/Compose/blob/120348af74dbcdccde5d091d5c92f84ffed4753d/src/token/ERC1155/ERC1155Mod.sol)



<Callout type="info" title="Key Features">
- Implements essential ERC-1155 functionality, including minting, burning, and transferring tokens.\n- Supports batch operations for gas efficiency.\n- Adheres to the EIP-1155 safe transfer standard, ensuring robust interaction with compliant contracts.
</Callout>



<Callout type="info" title="Module Usage">
This module provides internal functions for use in your custom facets. Import it to access shared logic and storage.
</Callout>


## Storage


Storage position: `STORAGE_POSITION` - Used for diamond storage pattern.



### State Variables


#### STORAGE_POSITION







## Functions


### burn


Burns a single token type from an address. Decreases the balance and emits a TransferSingle event. Reverts if the account has insufficient balance. **Parameters**



```solidity
function burn(address _from, uint256 _id, uint256 _value) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_from` | `address` | The address whose tokens will be burned. |

| `_id` | `uint256` | The token type to burn. |

| `_value` | `uint256` | The amount of tokens to burn. |





### burnBatch


Burns multiple token types from an address in a single transaction. Decreases balances for each token type and emits a TransferBatch event. Reverts if the account has insufficient balance for any token type. **Parameters**



```solidity
function burnBatch(address _from, uint256[] memory _ids, uint256[] memory _values) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_from` | `address` | The address whose tokens will be burned. |

| `_ids` | `uint256[]` | The token types to burn. |

| `_values` | `uint256[]` | The amounts of tokens to burn for each type. |





### getStorage


Returns the ERC-1155 storage struct from the predefined diamond storage slot. Uses inline assembly to set the storage slot reference. **Returns**



```solidity
function getStorage() pure returns (ERC1155Storage storage s);
```




**Returns**

| Name | Type | Description |
|------|------|-------------|

| `s` | `ERC1155Storage` | The ERC-1155 storage struct reference. |




### mint


Mints a single token type to an address. Increases the balance and emits a TransferSingle event. Performs receiver validation if recipient is a contract. **Parameters**



```solidity
function mint(address _to, uint256 _id, uint256 _value, bytes memory _data) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_to` | `address` | The address that will receive the tokens. |

| `_id` | `uint256` | The token type to mint. |

| `_value` | `uint256` | The amount of tokens to mint. |





### mintBatch


Mints multiple token types to an address in a single transaction. Increases balances for each token type and emits a TransferBatch event. Performs receiver validation if recipient is a contract. **Parameters**



```solidity
function mintBatch(address _to, uint256[] memory _ids, uint256[] memory _values, bytes memory _data) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_to` | `address` | The address that will receive the tokens. |

| `_ids` | `uint256[]` | The token types to mint. |

| `_values` | `uint256[]` | The amounts of tokens to mint for each type. |





### safeBatchTransferFrom


Safely transfers multiple token types from one address to another in a single transaction. Validates ownership, approval, and receiver address before updating balances for each token type. Performs ERC1155Receiver validation if recipient is a contract (safe transfer). Complies with EIP-1155 safe transfer requirements. **Parameters**



```solidity
function safeBatchTransferFrom(
address _from,
address _to,
uint256[] memory _ids,
uint256[] memory _values,
address _operator
) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_from` | `address` | The address to transfer from. |

| `_to` | `address` | The address to transfer to. |

| `_ids` | `uint256[]` | The token types to transfer. |

| `_values` | `uint256[]` | The amounts of tokens to transfer for each type. |

| `_operator` | `address` | The address initiating the transfer (may be owner or approved operator). |





### safeTransferFrom


Safely transfers a single token type from one address to another. Validates ownership, approval, and receiver address before updating balances. Performs ERC1155Receiver validation if recipient is a contract (safe transfer). Complies with EIP-1155 safe transfer requirements. **Parameters**



```solidity
function safeTransferFrom(address _from, address _to, uint256 _id, uint256 _value, address _operator) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_from` | `address` | The address to transfer from. |

| `_to` | `address` | The address to transfer to. |

| `_id` | `uint256` | The token type to transfer. |

| `_value` | `uint256` | The amount of tokens to transfer. |

| `_operator` | `address` | The address initiating the transfer (may be owner or approved operator). |





### setBaseURI


Sets the base URI prefix for token-specific URIs. The base URI is concatenated with token-specific URIs set via setTokenURI. Does not affect the default URI used when no token-specific URI is set. **Parameters**



```solidity
function setBaseURI(string memory _baseURI) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_baseURI` | `string` | The base URI string to prepend to token-specific URIs. |





### setTokenURI


Sets the token-specific URI for a given token ID. Sets tokenURIs[_tokenId] to the provided string and emits a URI event with the full computed URI. The emitted URI is the concatenation of baseURI and the token-specific URI. **Parameters**



```solidity
function setTokenURI(uint256 _tokenId, string memory _tokenURI) ;
```



**Parameters**

| Name | Type | Description |
|------|------|-------------|

| `_tokenId` | `uint256` | The token ID to set the URI for. |

| `_tokenURI` | `string` | The token-specific URI string to be concatenated with baseURI. |







## Events


### TransferBatch


Emitted when multiple token types are transferred. **Parameters**



```solidity
event TransferBatch(
address indexed _operator, address indexed _from, address indexed _to, uint256[] _ids, uint256[] _values
);
```



| Parameter | Type | Description |
|-----------|------|-------------|

| `_operator` | `address` | The address which initiated the batch transfer. |

| `_from` | `address` | The address which previously owned the tokens. |

| `_to` | `address` | The address which now owns the tokens. |

| `_ids` | `uint256[]` | The token types being transferred. |

| `_values` | `uint256[]` | The amounts of tokens transferred. |




### TransferSingle


Emitted when a single token type is transferred. **Parameters**



```solidity
event TransferSingle(
address indexed _operator, address indexed _from, address indexed _to, uint256 _id, uint256 _value
);
```



| Parameter | Type | Description |
|-----------|------|-------------|

| `_operator` | `address` | The address which initiated the transfer. |

| `_from` | `address` | The address which previously owned the token. |

| `_to` | `address` | The address which now owns the token. |

| `_id` | `uint256` | The token type being transferred. |

| `_value` | `uint256` | The amount of tokens transferred. |




### URI


Emitted when the URI for token type `_id` changes to `_value`. **Parameters**



```solidity
event URI(string _value, uint256 indexed _id);
```



| Parameter | Type | Description |
|-----------|------|-------------|

| `_value` | `string` | The new URI for the token type. |

| `_id` | `uint256` | The token type whose URI changed. |






## Errors


### ERC1155InsufficientBalance


**Title:** LibERC1155 â€” ERC-1155 Library Provides internal functions and storage layout for ERC-1155 multi-token logic. Thrown when insufficient balance for a transfer or burn operation. Uses ERC-8042 for storage location standardization and ERC-6093 for error conventions. This library is intended to be used by custom facets to integrate with ERC-1155 functionality. **Parameters**



```solidity
error ERC1155InsufficientBalance(address _sender, uint256 _balance, uint256 _needed, uint256 _tokenId);
```



### ERC1155InvalidArrayLength


Thrown when array lengths don't match in batch operations. **Parameters**



```solidity
error ERC1155InvalidArrayLength(uint256 _idsLength, uint256 _valuesLength);
```



### ERC1155InvalidReceiver


Thrown when the receiver address is invalid. **Parameters**



```solidity
error ERC1155InvalidReceiver(address _receiver);
```



### ERC1155InvalidSender


Thrown when the sender address is invalid. **Parameters**



```solidity
error ERC1155InvalidSender(address _sender);
```



### ERC1155MissingApprovalForAll


Thrown when missing approval for an operator. **Parameters**



```solidity
error ERC1155MissingApprovalForAll(address _operator, address _owner);
```





## Structs


### ERC1155Storage


ERC-8042 compliant storage struct for ERC-1155 token data. **Note:** storage-location: erc8042:compose.erc1155



```solidity
struct ERC1155Storage {
mapping(uint256 id =&gt; mapping(address account =&gt; uint256 balance)) balanceOf;
mapping(address account =&gt; mapping(address operator =&gt; bool)) isApprovedForAll;
string uri;
string baseURI;
mapping(uint256 tokenId =&gt; string) tokenURIs;
}
```





## Usage Example

```solidity
contract MyDiamond {\n    // Add ERC1155Mod to your diamond\n    function mintExample(address _to, uint256 _id, uint256 _amount) external {\n        ERC1155Mod.mint(_to, _id, _amount, &#39;&#39;);\n    }\n    function transferTokens(address _from, address _to, uint256 _id, uint256 _amount) external {\n        ERC1155Mod.safeTransferFrom(_from, _to, _id, _amount, &#39;&#39;);\n    }\n    function updateTokenURI(uint256 _id, string memory _newURI) external {\n        ERC1155Mod.setTokenURI(_id, _newURI);\n    }\n}
```



## Best Practices

<Callout type="tip" title="Best Practice">
- Verify recipient addresses, especially if they are contracts, to ensure compatibility with the ERC1155Receiver interface.\n- Use batch operations such as mintBatch and burnBatch to save on gas fees when interacting with multiple token types.\n- Define a clear URI policy for tokens to ensure proper metadata fetching and linking.
</Callout>





## Integration Notes

<Callout type="success" title="Shared Storage">
The ERC1155Mod uses diamond storage slots to maintain state in a manner compliant with the EIP-2535 Diamond Standard. Any state changes made through this module, such as token balances or metadata updates, are uniformly accessible to all facets within the same diamond. This ensures consistency and avoids data duplication across the system.
</Callout>




