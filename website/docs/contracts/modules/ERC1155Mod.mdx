---
sidebar_position: 99
title: "ERC1155Mod"
description: "ERC-1155 Token Receiver Interface - Handles the receipt of a single ERC-1155 token type."
gitSource: "https://github.com/maxnorm/Compose/blob/7cec432f52f2cad53f4d546df90deb49e6a66d41/src/token/ERC1155/ERC1155Mod.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
ERC-1155 Token Receiver Interface - Handles the receipt of a single ERC-1155 token type.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Supports both single token transfers (&#x60;safeTransferFrom&#x60;) and batch transfers (&#x60;safeBatchTransferFrom&#x60;).
- Implements minting and burning for both single token types and batches.
- Allows setting a base URI and token-specific URIs, compatible with EIP-5192 for metadata.
- Includes receiver validation for contract addresses to ensure safe token transfers.
</Callout>

<Callout type="info" title="Module Usage">
This module provides internal functions for use in your custom facets. Import it to access shared logic and storage.
</Callout>

## Overview

The ERC1155Mod facet provides a robust implementation for the ERC-1155 token standard, enabling the management of fungible and non-fungible tokens within a Compose diamond. It handles minting, burning, transfers, and URI management, ensuring composability and adherence to EIP-1155 standards.

---

## Storage

### ERC1155Storage

ERC-8042 compliant storage struct for ERC-1155 token data. **Note:** storage-location: erc8042:compose.erc1155

<ExpandableCode language="solidity" maxLines={15} title="Definition">
{`struct ERC1155Storage {
mapping(uint256 id => mapping(address account => uint256 balance)) balanceOf;
mapping(address account => mapping(address operator => bool)) isApprovedForAll;
string uri;
string baseURI;
mapping(uint256 tokenId => string) tokenURIs;
}`}
</ExpandableCode>

Storage position: &#x60;STORAGE_POSITION&#x60; - Used for diamond storage pattern.
---
### State Variables

<PropertyTable
  properties={[
    {
      name: "STORAGE_POSITION",
      type: "bytes32",
      description: " (Value: `keccak256(&quot;compose.erc1155&quot;)`)"
    }
  ]}
  showRequired={false}
/>

## Functions

### burn

Burns a single token type from an address. Decreases the balance and emits a TransferSingle event. Reverts if the account has insufficient balance. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function burn(address _from, uint256 _id, uint256 _value) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_from",
      type: "address",
      description: "The address whose tokens will be burned."
    },
    {
      name: "_id",
      type: "uint256",
      description: "The token type to burn."
    },
    {
      name: "_value",
      type: "uint256",
      description: "The amount of tokens to burn."
    }
  ]}
  showRequired={false}
/>

---
### burnBatch

Burns multiple token types from an address in a single transaction. Decreases balances for each token type and emits a TransferBatch event. Reverts if the account has insufficient balance for any token type. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function burnBatch(address _from, uint256[] memory _ids, uint256[] memory _values) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_from",
      type: "address",
      description: "The address whose tokens will be burned."
    },
    {
      name: "_ids",
      type: "uint256[]",
      description: "The token types to burn."
    },
    {
      name: "_values",
      type: "uint256[]",
      description: "The amounts of tokens to burn for each type."
    }
  ]}
  showRequired={false}
/>

---
### getStorage

Returns the ERC-1155 storage struct from the predefined diamond storage slot. Uses inline assembly to set the storage slot reference. **Returns**

<ExpandableCode language="solidity" maxLines={8}>
{`function getStorage() pure returns (ERC1155Storage storage s);`}
</ExpandableCode>

**Returns:**

<PropertyTable
  properties={[
    {
      name: "s",
      type: "ERC1155Storage",
      description: "The ERC-1155 storage struct reference."
    }
  ]}
  showRequired={false}
/>

---
### mint

Mints a single token type to an address. Increases the balance and emits a TransferSingle event. Performs receiver validation if recipient is a contract. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function mint(address _to, uint256 _id, uint256 _value, bytes memory _data) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_to",
      type: "address",
      description: "The address that will receive the tokens."
    },
    {
      name: "_id",
      type: "uint256",
      description: "The token type to mint."
    },
    {
      name: "_value",
      type: "uint256",
      description: "The amount of tokens to mint."
    }
  ]}
  showRequired={false}
/>

---
### mintBatch

Mints multiple token types to an address in a single transaction. Increases balances for each token type and emits a TransferBatch event. Performs receiver validation if recipient is a contract. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function mintBatch(address _to, uint256[] memory _ids, uint256[] memory _values, bytes memory _data) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_to",
      type: "address",
      description: "The address that will receive the tokens."
    },
    {
      name: "_ids",
      type: "uint256[]",
      description: "The token types to mint."
    },
    {
      name: "_values",
      type: "uint256[]",
      description: "The amounts of tokens to mint for each type."
    }
  ]}
  showRequired={false}
/>

---
### safeBatchTransferFrom

Safely transfers multiple token types from one address to another in a single transaction. Validates ownership, approval, and receiver address before updating balances for each token type. Performs ERC1155Receiver validation if recipient is a contract (safe transfer). Complies with EIP-1155 safe transfer requirements. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function safeBatchTransferFrom(
address _from,
address _to,
uint256[] memory _ids,
uint256[] memory _values,
address _operator
) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_from",
      type: "address",
      description: "The address to transfer from."
    },
    {
      name: "_to",
      type: "address",
      description: "The address to transfer to."
    },
    {
      name: "_ids",
      type: "uint256[]",
      description: "The token types to transfer."
    },
    {
      name: "_values",
      type: "uint256[]",
      description: "The amounts of tokens to transfer for each type."
    },
    {
      name: "_operator",
      type: "address",
      description: "The address initiating the transfer (may be owner or approved operator)."
    }
  ]}
  showRequired={false}
/>

---
### safeTransferFrom

Safely transfers a single token type from one address to another. Validates ownership, approval, and receiver address before updating balances. Performs ERC1155Receiver validation if recipient is a contract (safe transfer). Complies with EIP-1155 safe transfer requirements. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function safeTransferFrom(address _from, address _to, uint256 _id, uint256 _value, address _operator) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_from",
      type: "address",
      description: "The address to transfer from."
    },
    {
      name: "_to",
      type: "address",
      description: "The address to transfer to."
    },
    {
      name: "_id",
      type: "uint256",
      description: "The token type to transfer."
    },
    {
      name: "_value",
      type: "uint256",
      description: "The amount of tokens to transfer."
    },
    {
      name: "_operator",
      type: "address",
      description: "The address initiating the transfer (may be owner or approved operator)."
    }
  ]}
  showRequired={false}
/>

---
### setBaseURI

Sets the base URI prefix for token-specific URIs. The base URI is concatenated with token-specific URIs set via setTokenURI. Does not affect the default URI used when no token-specific URI is set. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function setBaseURI(string memory _baseURI) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_baseURI",
      type: "string",
      description: "The base URI string to prepend to token-specific URIs."
    }
  ]}
  showRequired={false}
/>

---
### setTokenURI

Sets the token-specific URI for a given token ID. Sets tokenURIs[_tokenId] to the provided string and emits a URI event with the full computed URI. The emitted URI is the concatenation of baseURI and the token-specific URI. **Parameters**

<ExpandableCode language="solidity" maxLines={8}>
{`function setTokenURI(uint256 _tokenId, string memory _tokenURI) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_tokenId",
      type: "uint256",
      description: "The token ID to set the URI for."
    },
    {
      name: "_tokenURI",
      type: "string",
      description: "The token-specific URI string to be concatenated with baseURI."
    }
  ]}
  showRequired={false}
/>

## Events

<AccordionGroup>
  <Accordion title="TransferBatch" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Emitted when multiple token types are transferred. **Parameters**
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event TransferBatch(
address indexed _operator, address indexed _from, address indexed _to, uint256[] _ids, uint256[] _values
);`}
      </ExpandableCode>
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Parameters:</strong>
      <PropertyTable
        properties={[
          {
            name: "_operator",
            type: "address",
            description: "The address which initiated the batch transfer."
          },
          {
            name: "_from",
            type: "address",
            description: "The address which previously owned the tokens."
          },
          {
            name: "_to",
            type: "address",
            description: "The address which now owns the tokens."
          },
          {
            name: "_ids",
            type: "uint256[]",
            description: "The token types being transferred."
          },
          {
            name: "_values",
            type: "uint256[]",
            description: "The amounts of tokens transferred."
          }
        ]}
        showRequired={false}
      />
    </div>
  </Accordion>
  <Accordion title="TransferSingle" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Emitted when a single token type is transferred. **Parameters**
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event TransferSingle(
address indexed _operator, address indexed _from, address indexed _to, uint256 _id, uint256 _value
);`}
      </ExpandableCode>
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Parameters:</strong>
      <PropertyTable
        properties={[
          {
            name: "_operator",
            type: "address",
            description: "The address which initiated the transfer."
          },
          {
            name: "_from",
            type: "address",
            description: "The address which previously owned the token."
          },
          {
            name: "_to",
            type: "address",
            description: "The address which now owns the token."
          },
          {
            name: "_id",
            type: "uint256",
            description: "The token type being transferred."
          },
          {
            name: "_value",
            type: "uint256",
            description: "The amount of tokens transferred."
          }
        ]}
        showRequired={false}
      />
    </div>
  </Accordion>
  <Accordion title="URI" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Emitted when the URI for token type &#x60;_id&#x60; changes to &#x60;_value&#x60;. **Parameters**
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
{`event URI(string _value, uint256 indexed _id);`}
      </ExpandableCode>
    </div>

    <div style={{marginBottom: "1rem"}}>
      <strong>Parameters:</strong>
      <PropertyTable
        properties={[
          {
            name: "_value",
            type: "string",
            description: "The new URI for the token type."
          },
          {
            name: "_id",
            type: "uint256",
            description: "The token type whose URI changed."
          }
        ]}
        showRequired={false}
      />
    </div>
  </Accordion>
</AccordionGroup>

## Errors

<AccordionGroup>
  <Accordion title="ERC1155InsufficientBalance" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      **Title:** LibERC1155 â€” ERC-1155 Library Provides internal functions and storage layout for ERC-1155 multi-token logic. Thrown when insufficient balance for a transfer or burn operation. Uses ERC-8042 for storage location standardization and ERC-6093 for error conventions. This library is intended to be used by custom facets to integrate with ERC-1155 functionality. **Parameters**
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error ERC1155InsufficientBalance(address _sender, uint256 _balance, uint256 _needed, uint256 _tokenId);
      </ExpandableCode>
    </div>
  </Accordion>
  <Accordion title="ERC1155InvalidArrayLength" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Thrown when array lengths don&#x27;t match in batch operations. **Parameters**
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error ERC1155InvalidArrayLength(uint256 _idsLength, uint256 _valuesLength);
      </ExpandableCode>
    </div>
  </Accordion>
  <Accordion title="ERC1155InvalidReceiver" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Thrown when the receiver address is invalid. **Parameters**
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error ERC1155InvalidReceiver(address _receiver);
      </ExpandableCode>
    </div>
  </Accordion>
  <Accordion title="ERC1155InvalidSender" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Thrown when the sender address is invalid. **Parameters**
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error ERC1155InvalidSender(address _sender);
      </ExpandableCode>
    </div>
  </Accordion>
  <Accordion title="ERC1155MissingApprovalForAll" defaultOpen={false}>
    <div style={{marginBottom: "1rem"}}>
      Thrown when missing approval for an operator. **Parameters**
    </div>

    <div>
      <strong>Signature:</strong>
      <ExpandableCode language="solidity" maxLines={5}>
error ERC1155MissingApprovalForAll(address _operator, address _owner);
      </ExpandableCode>
    </div>
  </Accordion>
</AccordionGroup>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IERC1155Mod} from "@compose/contracts/facets/ERC1155/interfaces/IERC1155Mod.sol";
import {IERC1155} from "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";

contract MyERC1155ConsumerFacet {
    IERC1155Mod public erc1155Facet;

    function setErc1155Facet(address _facetAddress) external {
        erc1155Facet = IERC1155Mod(_facetAddress);
    }

    function mintTokens(address _to, uint256 _id, uint256 _amount) external {
        // Assuming caller has sufficient permissions to mint
        erc1155Facet.mint(_to, _id, _amount);
    }

    function transferTokens(address _from, address _to, uint256 _id, uint256 _amount) external {
        // Assuming caller has sufficient permissions and _from is the caller
        erc1155Facet.safeTransferFrom(_from, _to, _id, _amount, "");
    }

    function burnTokens(address _from, uint256 _id, uint256 _amount) external {
        // Assuming caller has sufficient permissions and _from is the caller
        erc1155Facet.burn(_from, _id, _amount);
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Ensure proper access control is implemented for minting, burning, and URI setting functions. Rely on diamond&#x27;s access control mechanisms rather than duplicating checks within the facet.
- When implementing receiver contracts for transfers, ensure they correctly implement the &#x60;onERC1155Received&#x60; or &#x60;onERC1155BatchReceived&#x60; hooks to handle token receipts safely.
- Be mindful of storage slot usage. The ERC1155Mod facet uses a predefined slot for its storage. Avoid conflicts when composing other facets.
</Callout>

## Integration Notes

<Callout type="success" title="Shared Storage">
The ERC1155Mod facet interacts with the diamond&#x27;s storage through a predefined storage slot. It manages its state, including token balances, approvals, base URIs, and token-specific URIs, within this slot. Facets can access this state via the &#x60;getStorage&#x60; function or by directly calling the facet&#x27;s functions, which internally manage the storage updates. Changes to token balances and URIs are immediately visible to all facets interacting with the diamond.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ERC1155Mod" />
</div>

<LastUpdated date="2025-12-19T19:09:55.731Z" />
