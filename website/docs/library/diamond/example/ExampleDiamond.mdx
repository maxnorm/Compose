---
sidebar_position: 510
title: "ExampleDiamond"
description: "Diamond proxy contract for managing facets and ownership."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Diamond proxy contract for managing facets and ownership.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Manages facet registration and routing.
- Supports diamond upgradeability through facet management.
- Establishes contract ownership for administrative control.
</Callout>

## Overview

ExampleDiamond serves as the core diamond proxy contract, responsible for managing facet installations, upgrades, and ownership. It acts as the central router, directing external calls to the appropriate facet based on function selectors. This provides a flexible and upgradeable smart contract architecture.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {ExampleDiamond} from "@compose-protocol/diamond/contracts/ExampleDiamond.sol";
import {IDiamondCut} from "@compose-protocol/diamond/contracts/interfaces/IDiamondCut.sol";

contract DeployExampleDiamond {
    address owner = msg.sender;

    function deploy() public {
        ExampleDiamond diamond = new ExampleDiamond();
        // Assume facetAddresses and facetSelectors are populated
        // For example, during deployment scripts
        address[] memory facetAddresses = new address[](1);
        bytes4[][] memory facetSelectors = new bytes4[][](1);

        // Placeholder for actual facet registration logic
        // In a real scenario, you would add facets here using IDiamondCut.diamondCut()

        // Example of initial setup (replace with actual facet cuts)
        // diamond.diamondCut(facetCuts, address(0), "");
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond contract with the owner and initial facets during deployment.
- Use the `diamondCut` function (from `IDiamondCut`) to add, replace, or remove facets.
- Ensure function selectors are correctly mapped to facet addresses to enable proper routing.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Access control for `diamondCut` operations should be strictly enforced to prevent unauthorized facet modifications. Ensure all facets are audited before installation. Reentrancy risks are mitigated by the diamond proxy pattern itself, as calls are delegatecalled to facets, but individual facet implementations must be secure.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T14:36:46.928Z" />
