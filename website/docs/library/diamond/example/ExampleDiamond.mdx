---
sidebar_position: 510
title: "ExampleDiamond"
description: "Example Diamond initialization and fallback handlers."
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example Diamond initialization and fallback handlers.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Initializes the diamond with provided facets and owner.
- Registers function selectors for delegatecall routing.
- Includes `fallback` and `receive` for unrouted calls and Ether transfers.
</Callout>

## Overview

The ExampleDiamond contract serves as a foundational template for Compose diamond deployments. It handles the initial setup of the diamond by registering facets and their function selectors, and includes fallback and receive functions for handling unrouted calls and Ether transfers respectively.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {ExampleDiamond} from "@compose/diamond/example/ExampleDiamond";
import {DiamondMod} from "@compose/diamond/DiamondMod";

contract MyDiamond is ExampleDiamond {
    constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ExampleDiamond(_facets, _diamondOwner) {
        // Additional diamond initialization logic can go here
    }

    // Fallback and receive functions are inherited from ExampleDiamond
}

// Deployment script snippet (conceptual):
// function deployMyDiamond() public {
//     address owner = msg.sender;
//     DiamondMod.FacetCut[] memory initialFacets = new DiamondMod.FacetCut[](2);
//     // ... populate initialFacets with facet definitions ...
//     MyDiamond diamond = new MyDiamond(initialFacets, owner);
//     // ... further setup ...
// }`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with all intended facets and their function selectors during deployment.
- Ensure the `_diamondOwner` parameter is set correctly to manage ownership and upgrades.
- Understand that unrouted calls will hit the `fallback` or `receive` functions.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The `constructor` function is critical for initial setup. Ensure the `_facets` array is correctly populated with trusted facet addresses and their respective function selectors. Incorrect initialization could lead to unintended behavior or unroutable functions. The `fallback` and `receive` functions, by default, do not implement specific logic, meaning any Ether sent to unrouted calls will be accepted, and unrouted calls will result in a gas refund if no `fallback` is implemented by a facet. Consider adding explicit logic to these if specific behavior for unrouted calls or Ether reception is required.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T17:11:15.478Z" />
