---
sidebar_position: 510
title: "ExampleDiamond"
description: "Example diamond initialization and fallback handling"
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Example diamond initialization and fallback handling
</DocSubtitle>

<Callout type="info" title="Key Features">
- Provides an example constructor for diamond initialization.
- Includes fallback and receive functions for Ether handling.
- Demonstrates facet registration via constructor arguments.
- Self-contained example, no external dependencies beyond Compose core.
</Callout>

## Overview

This module serves as an example for initializing a diamond with facets and handling fallback and receive calls. It demonstrates how to structure diamond deployments by accepting an array of facet cuts and an owner address during construction. The fallback and receive functions allow the diamond to accept Ether.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

<!-- Usage Example section commented out for now -->
<!--
## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity >=0.8.30;

import { ExampleDiamond } from "@compose/diamond/example/ExampleDiamond";
import { IDiamond } from "@compose/diamond/IDiamond";
import { DiamondCutFacet } from "@compose/diamond/facets/DiamondCutFacet";
import { DiamondLoupeFacet } from "@compose/diamond/facets/DiamondLoupeFacet";

contract DeployExampleDiamond {
    address public deployedDiamond;

    constructor(address[] memory facetAddresses, bytes[] memory facetCuts) {
        // Example of deploying a diamond using ExampleDiamond
        // In a real scenario, facetCuts would be properly constructed
        // For simplicity, this example assumes facetCuts are pre-formatted
        ExampleDiamond diamond = new ExampleDiamond(
            diamondOwner,
            new DiamondMod.FacetCut[](0) // Placeholder for actual facet cuts
        );

        // In a real deployment, you would add facets here.
        // For example, adding DiamondCutFacet and DiamondLoupeFacet:
        // address diamondCutFacetAddress = address(new DiamondCutFacet());
        // address diamondLoupeFacetAddress = address(new DiamondLoupeFacet());
        //
        // diamond.diamondCut(
        //     address(diamondCutFacetAddress),
        //     FacetCutAction.Add,
        //     DiamondCutFacet.getSelectors()
        // );
        // diamond.diamondCut(
        //     address(diamondLoupeFacetAddress),
        //     FacetCutAction.Add,
        //     DiamondLoupeFacet.getSelectors()
        // );

        deployedDiamond = address(diamond);
    }
}`}
</ExpandableCode>
-->

## Best Practices

<Callout type="tip" title="Best Practice">
- Initialize the diamond with facets and owner using the constructor.
- Ensure facet cut data is correctly formatted before passing to the constructor.
- Use the fallback and receive functions to allow Ether reception by the diamond.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Follow standard Solidity security practices. Ensure that the `diamondOwner` is set to a secure address. Validate the integrity and source of facet addresses and selectors during initialization.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T17:42:36.183Z" />
