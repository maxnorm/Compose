---
sidebar_position: 99
title: "ExampleDiamond"
description: "Initializes and manages diamond facets and ownership."
gitSource: "https://github.com/maxnorm/Compose/blob/7e2dd824639f424be644c4ebbb3ca2508167329f/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Initializes and manages diamond facets and ownership.
</DocSubtitle>

<Callout type="info" title="Key Features">
- Registers facets and their function selectors for delegatecall routing.
- Sets the initial owner of the diamond contract.
- Supports adding, replacing, or removing facets via `diamondCut`.
</Callout>

## Overview

The ExampleDiamond facet provides essential initialization logic for a diamond proxy. It registers facets and their function selectors, enabling delegatecall routing, and sets the initial contract owner. This ensures the diamond is correctly configured upon deployment.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetCut &#123; address facetAddress; FacetCutAction action; // Add=0, Replace=1, Remove=2 bytes4[] functionSelectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetCut[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetCut[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity ^0.8.30;

import {IDiamondCut} from "@compose/diamond-cut/IDiamondCut.sol";
import {ExampleDiamond} from "@compose/example-diamond/ExampleDiamond.sol";

contract Deployer {
    function deployDiamond(address _owner) external {
        ExampleDiamond exampleDiamond = new ExampleDiamond();

        // Define facets to be added
        IDiamondCut.FacetCut[] memory facets = new IDiamondCut.FacetCut[](1);
        // Assume MyFacet and its selectors are defined elsewhere
        // facets[0] = IDiamondCut.FacetCut({
        //     facetAddress: address(new MyFacet()),
        //     action: IDiamondCut.FacetCutAction.Add,
        //     functionSelectors: MyFacet.getSelectors() // Example selector retrieval
        // });

        // Initialize the diamond with facets and owner
        // exampleDiamond.diamondCut(facets, address(0), "");
        // exampleDiamond.transferOwnership(_owner); // Ownership transfer
    }
}`}
</ExpandableCode>

## Best Practices

<Callout type="tip" title="Best Practice">
- Ensure all facets and their function selectors are correctly defined and passed during initialization.
- Transfer ownership immediately after initialization to a secure multisig or admin address.
- Use explicit initializer functions in deployment scripts rather than relying on constructors.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
Access control for `diamondCut` and `transferOwnership` must be strictly managed to prevent unauthorized modifications to the diamond's structure or ownership. Ensure that the provided facet addresses are verified and intended before registration.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-21T21:55:24.994Z" />
