---
sidebar_position: 510
title: "ExampleDiamond"
description: "Initializes a diamond with facets and owner"
gitSource: "https://github.com/Perfect-Abstractions/Compose/tree/main/src/diamond/example/ExampleDiamond.sol"
---

import DocSubtitle  from '@site/src/components/docs/DocSubtitle';
import Badge from '@site/src/components/ui/Badge';
import Callout from '@site/src/components/ui/Callout';
import CalloutBox from '@site/src/components/ui/CalloutBox';
import Accordion, { AccordionGroup } from '@site/src/components/ui/Accordion';
import PropertyTable from '@site/src/components/api/PropertyTable';
import ExpandableCode from '@site/src/components/code/ExpandableCode';
import CodeShowcase from '@site/src/components/code/CodeShowcase';
import RelatedDocs from '@site/src/components/docs/RelatedDocs';
import WasThisHelpful from '@site/src/components/docs/WasThisHelpful';
import LastUpdated from '@site/src/components/docs/LastUpdated';
import ReadingTime from '@site/src/components/docs/ReadingTime';
import GradientText from '@site/src/components/ui/GradientText';
import GradientButton from '@site/src/components/ui/GradientButton';

<DocSubtitle>
Initializes a diamond with facets and owner
</DocSubtitle>

<Callout type="info" title="Key Features">
- Initializes diamond with an owner and a set of facets.
- Maps function selectors to facet addresses for call routing.
- Designed for initial diamond setup.
</Callout>

## Overview

This constructor function initializes a diamond contract by registering provided facets and setting the diamond's owner. It maps function selectors to their respective facet addresses, enabling the diamond proxy to route calls correctly. Developers use this during deployment to configure the diamond's initial functionality.

---

## Storage

## Functions

### constructor

Struct to hold facet address and its function selectors. struct FacetFunctions &#123; address facet; bytes4[] selectors; &#125; Initializes the diamond contract with facets, owner and other data. Adds all provided facets to the diamond's function selector mapping and sets the contract owner. Each facet in the array will have its function selectors registered to enable delegatecall routing.

<ExpandableCode language="solidity" maxLines={8}>
{`constructor(DiamondMod.FacetFunctions[] memory _facets, address _diamondOwner) ;`}
</ExpandableCode>

**Parameters:**

<PropertyTable
  properties={[
    {
      name: "_facets",
      type: "DiamondMod.FacetFunctions[]",
      description: "Array of facet addresses and their corresponding function selectors to add to the diamond."
    },
    {
      name: "_diamondOwner",
      type: "address",
      description: "Address that will be set as the owner of the diamond contract."
    }
  ]}
  showRequired={false}
/>

---
### fallback

<ExpandableCode language="solidity" maxLines={8}>
{`fallback() external payable;`}
</ExpandableCode>

---
### receive

<ExpandableCode language="solidity" maxLines={8}>
{`receive() external payable;`}
</ExpandableCode>

<!-- Usage Example section commented out for now -->
<!--
## Usage Example

<ExpandableCode language="solidity" maxLines={20} title="Example Implementation">
{`pragma solidity >=0.8.30;

import {IDiamond, DiamondMod} from "@compose/diamond/example/ExampleDiamond";

contract DeployExampleDiamond {
    address public diamondAddress;

    constructor(address _diamondOwner, DiamondMod.FacetFunctions[] memory _facets) {
        // Deploy the diamond contract
        // Note: In a real deployment, the diamond contract itself would be deployed first.
        // This example assumes the diamond contract is already deployed and we are interacting with its constructor logic (or an initializer).
        // For a true deployment flow, you would typically deploy a DiamondProxy contract and then initialize it.

        // Mocking the interaction with a deployed diamond's initialization
        // In a real scenario, you'd call an initializer function on the deployed diamond proxy.
        // Example: diamondProxy.initialize(_facets, _diamondOwner);

        // For demonstration purposes, we simulate the constructor call:
        // The actual diamond contract deployment would handle this.
        // diamondAddress = address(new ExampleDiamond(_facets, _diamondOwner)); // This is conceptual

        // In a real Compose deployment, you would deploy a DiamondProxy and then use an initializer facet to add other facets.
        // For example:
        // DiamondProxy diamondProxy = new DiamondProxy(address(this)); // Assuming DiamondProxy takes an owner
        // diamondAddress = address(diamondProxy);
        // diamondProxy.diamondCut(...);

        // To simulate the function call as per the provided constructor signature:
        // This requires a deployed instance of ExampleDiamond, which isn't typical for a Facet.
        // The ExampleDiamond contract itself is a library/implementation, not a proxy.
        // Therefore, directly calling its constructor in a usage example is illustrative of its internal logic.

        // To illustrate adding facets to a diamond:
        DiamondMod.FacetFunctions[] memory facetsToAdd = new DiamondMod.FacetFunctions[](1);
        facetsToAdd[0] = DiamondMod.FacetFunctions({
            facet: address(0x123), // Replace with actual facet address
            selectors: new bytes4[](1)
        });
        facetsToAdd[0].selectors[0] = bytes4(keccak256(bytes("transfer(address,uint256)"))); // Example selector

        // Assuming 'diamondAddress' points to a deployed DiamondProxy contract
        // IDiamond(diamondAddress).diamondCut(...); // Actual diamond cut logic would be here
    }
}
`}
</ExpandableCode>
-->

## Best Practices

<Callout type="tip" title="Best Practice">
- Use the constructor only during initial diamond deployment.
- Ensure the `_facets` array contains valid facet addresses and their respective function selectors.
- Verify that the `_diamondOwner` is set correctly for administrative control.
</Callout>

## Security Considerations

<Callout type="warning" title="Security">
The constructor is intended for deployment only. Ensure proper access control is implemented in separate facets for functions that modify diamond state after initialization. Validate all input parameters to prevent unexpected behavior or state corruption.
</Callout>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <RelatedDocs
    items={[
      {
        title: "ExampleDiamond",
        href: "/docs/library/diamond/example/ExampleDiamond",
        description: "Module used by ExampleDiamond",
        icon: "ðŸ“¦"
      },
      {
        title: "DiamondInspectFacet",
        href: "/docs/library/diamond/DiamondInspectFacet",
        description: "Related facet in diamond",
        icon: "ðŸ’Ž"
      }
    ]}
  />
</div>

<div style={{marginTop: "3rem", paddingTop: "2rem", borderTop: "1px solid var(--ifm-color-emphasis-200)"}}>
  <WasThisHelpful pageId="ExampleDiamond" />
</div>

<LastUpdated date="2025-12-30T20:09:34.157Z" />
